<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dynamic Random Patterns</title>
  <style>
    body { margin: 0; overflow: hidden; background-color: black; }
    canvas { display: block; touch-action: none; }
  </style>
</head>
<body>
<canvas id="patternCanvas"></canvas>
<script>
  const canvas = document.getElementById("patternCanvas");
  const ctx = canvas.getContext("2d");
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;

  // Random starting variables
  let baseFrequencyX = Math.random() * 0.02 + 0.01;
  let baseFrequencyY = Math.random() * 0.02 + 0.01;
  let intensity = Math.random() * 150 + 50;

  let targetFrequencyX = baseFrequencyX;
  let targetFrequencyY = baseFrequencyY;
  let targetIntensity = intensity;

  let phaseShiftX = Math.random() * Math.PI * 2; // Random phase shifts
  let phaseShiftY = Math.random() * Math.PI * 2;

  const colors = ["#FF0000", "#FF7F00", "#FFFF00", "#00FF00", "#0000FF", "#8B00FF", "#FF0000"];

  let isDragging = false;
  let lastX = 0;

  // Smooth interpolation to new random targets
  function interpolateParameters() {
    baseFrequencyX += (targetFrequencyX - baseFrequencyX) * 0.01;
    baseFrequencyY += (targetFrequencyY - baseFrequencyY) * 0.01;
    intensity += (targetIntensity - intensity) * 0.01;

    // When values are close enough, pick new random targets
    if (Math.abs(baseFrequencyX - targetFrequencyX) < 0.0001) {
      targetFrequencyX = Math.random() * 0.02 + 0.01;
    }
    if (Math.abs(baseFrequencyY - targetFrequencyY) < 0.0001) {
      targetFrequencyY = Math.random() * 0.02 + 0.01;
    }
    if (Math.abs(intensity - targetIntensity) < 1) {
      targetIntensity = Math.random() * 100 + 30;
    }
  }

  function drawPattern(time) {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.globalCompositeOperation = "lighter";

    const rows = 80;
    const cols = 80;

    for (let i = 0; i < rows; i++) {
      for (let j = 0; j < cols; j++) {
        const x = j * (canvas.width / cols);
        const y = i * (canvas.height / rows);

        // Randomized oscillation with phase shifts
        const offsetX = Math.sin((time * baseFrequencyX) + phaseShiftX + (i * 0.1)) * intensity;
        const offsetY = Math.cos((time * baseFrequencyY) + phaseShiftY + (j * 0.1)) * intensity;

        const radius = Math.abs(offsetX * offsetY) / 2000 + 2;

        // Vibrant color gradients
        const gradient = ctx.createRadialGradient(x + offsetX, y + offsetY, radius / 2, x, y, radius);
        gradient.addColorStop(0, colors[(i + j) % colors.length]);
        gradient.addColorStop(0.5, "#000000");
        gradient.addColorStop(1, "black");

        ctx.fillStyle = gradient;

        ctx.beginPath();
        ctx.arc(x + offsetX, y + offsetY, radius, 0, Math.PI * 2);
        ctx.fill();
      }
    }
  }

  function animate(time) {
    interpolateParameters();
    drawPattern(time * 0.02); // Normalize time
    requestAnimationFrame(animate);
  }

  animate(0);

  // Cross-device drag interaction to adjust intensity
  function handleDragStart(e) {
    isDragging = true;
    lastX = e.clientX || e.touches[0].clientX;
  }

  function handleDragMove(e) {
    if (isDragging) {
      const clientX = e.clientX || e.touches[0].clientX;
      const deltaX = clientX - lastX;
      intensity += deltaX * 0.5;
      intensity = Math.max(20, Math.min(intensity, 100));
      lastX = clientX;
    }
  }

  function handleDragEnd() {
    isDragging = false;
  }

  // Event listeners for drag (mouse and touch)
  canvas.addEventListener("mousedown", handleDragStart);
  canvas.addEventListener("mousemove", handleDragMove);
  canvas.addEventListener("mouseup", handleDragEnd);
  canvas.addEventListener("mouseleave", handleDragEnd);

  canvas.addEventListener("touchstart", handleDragStart);
  canvas.addEventListener("touchmove", handleDragMove);
  canvas.addEventListener("touchend", handleDragEnd);

  // Canvas resize support
  window.addEventListener("resize", () => {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  });
</script>
</body>
</html>
